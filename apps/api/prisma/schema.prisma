// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

enum Status {
  pending
  in_progress
  done
}

enum Ticket {
  paid
  free
}

model User {
  id          Int           @unique @default(autoincrement())
  username    String        @unique
  email       String        @unique
  password    String
  referal     String?       @unique
  point       Int @default(0)
  avatar      String?
  phone       String?
  isVerify    Boolean @default(false)
  Transaction Transaction[]
  Riview      Riview[]
}

model EO {
  id       Int     @unique @default(autoincrement())
  username String  @unique
  email    String  @unique
  password String
  avatar   String?
  phone    String?
  isVerify Boolean @default(false)

  Events Events[]
}

model Transaction {
  id            Int      @unique @default(autoincrement())
  eventId       Int
  userId        Int
  quantity      Int
  createdAt     DateTime @default(now())
  totalPrice    Int
  totalDiscount Int
  finalPrice    Int
  status        Status
  proof         String
  user          User     @relation(fields: [userId], references: [id])
  event         Events   @relation(fields: [eventId], references: [id])
}

model Riview {
  id      Int    @unique @default(autoincrement())
  review  String
  ratings Int
  userId  Int
  eventId Int
  user    User   @relation(fields: [userId], references: [id])
  event   Events @relation(fields: [eventId], references: [id])
}

model Events {
  id           Int           @unique @default(autoincrement())
  name         String
  price        Int
  date         DateTime
  location     String
  description  String        @db.Text
  seats        Int
  ticket_types Ticket
  EoId         Int
  image        String
  category     String
  Transaction  Transaction[]
  Riview       Riview[]
  Promotion    Promotion[]
  eo           EO            @relation(fields: [EoId], references: [id])
  
}

model Promotion {
  id          Int      @unique @default(autoincrement())
  startDate   DateTime
  endDate     DateTime
  voucherCode String
  qouta       Int
  percentage  Int
  eventId     Int
  event       Events   @relation(fields: [eventId], references: [id])
}
